# テスト共通設定

## はじめに
このドキュメントは、テスト実行時の共通設定と手順をまとめたものです。
各テストケースを実行する前に、必ずこの内容を確認してください。

## テスト実行の原則

1. テストケースの確認
   - テスト実行前に、必ず対象のテストケースの手順書を読み直すこと
   - 手順書の内容を完全に理解してから実行を開始すること
   - 不明点がある場合は、実行前に確認すること
   - 手順に記載されていない操作は実行しないこと
   - 手順の順序を変更しないこと
   - 手順を省略しないこと

2. テストの独立性
   - 各テストケースは独立して実行できる状態を保つこと
   - テストケース間の依存関係を作らないこと

3. 中断と確認の禁止
   - テストケース実行中は、手動での確認や判断を挟まないこと
   - すべての判断基準は事前に明確に定義されていること
   - 想定外の状況が発生した場合でも、テストを中断せず最後まで実行すること

4. エラー発生時の対応
   - 想定通りの動作をしなかった場合：
     1. テストを正常に終了させること（強制終了しない）
     2. 以下の情報を報告すること：
        - 発生した事象
        - 期待された動作
        - エラーの発生箇所
        - エラーの原因（推測される場合）
        - スクリーンショットやログ（利用可能な場合）

5. 再現性の確保
   - テストは同じ条件で複数回実行しても同じ結果が得られること
   - 環境依存の要素は事前に明確にすること

6. テストケースの終了条件
   - すべての手順が完了していること
   - ログアウトが完了していること
   - ブラウザが閉じられていること

## 環境設定

### テスト環境
- 開発環境: https://nanboku.dev.moge.app/

### テストアカウント
- ID: n020202
- パスワード: hoge1234
- 学校: 北中学校

## ブラウザ設定

### Playwright設定
- ブラウザ: Chromium
- ヘッドレスモード: 無効
- ビューポート: 1280x720
- タイムアウト: 30秒

### スクリーンショット設定
- 自動キャプチャ: エラー発生時
- 保存形式: PNG
- 保存先: e2e/screenshots/

## 共通手順

### テスト開始前の確認事項
1. インターネット接続の確認
2. ブラウザのバージョンが要件を満たしていることの確認
3. テスト環境が稼働していることの確認

### テスト開始時の手順
1. 新しいブラウザプロファイルを作成する
2. ブラウザを開く
3. キャッシュをクリアする
4. 開発環境のURLにアクセスする
5. ログイン画面が表示されることを確認する

### テスト終了時の手順
1. ログアウト状態であることを確認
   - ログイン中の場合は、ログアウト手順に従ってログアウトを実行

2. ブラウザのコンテキストをクリア
   ```javascript
   // テスト終了時に実行
   await context.clearCookies();
   await context.clearPermissions();
   ```

3. ブラウザを閉じる

4. スクリーンショットの確認
   - エラーが発生した場合は、スクリーンショットが正しく保存されているか確認
   - 必要に応じてスクリーンショットを整理

### ログアウト手順
1. 設定画面への遷移
   1. URLバーに `https://nanboku.dev.moge.app/setting` を入力
   2. Enterキーを押して、ページにアクセス
   3. 「設定」をクリック
   4. 設定画面が表示されることを確認
   
2. ログアウトの実行
   1. 「ログアウト」ボタンをクリック
   2. 確認ダイアログが表示されることを確認
   3. 確認ダイアログの「ログアウト」ボタンをクリック
   
3. ログアウト後の確認
   1. ログイン画面に遷移することを確認
   2. URLが `https://nanboku.dev.moge.app/` であることを確認
   3. ログインフォームが表示されていることを確認

## 実行時の注意事項
1. テスト実行前に必ずブラウザのキャッシュをクリアすること
2. 一度のテストで複数のブラウザウィンドウを開かないこと
3. テスト終了時は必ずログアウト状態にすること
4. 手順にない画面遷移を行わないこと
5. 手順にない操作を行わないこと
6. 手順にないボタンやリンクをクリックしないこと
7. 手順にない入力を行わないこと 